<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>UWP基础教程 - XAML标记扩展 | 陈仁松博客</title>
<link rel="shortcut icon" href="https://songsong.org/favicon.ico?v=1558973045118">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://songsong.org/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://songsong.org">
  <img class="avatar" src="https://songsong.org/images/avatar.png?v=1558973045118" alt="">
  </a>
  <h1 class="site-title">
    陈仁松博客
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/chenrensong" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
  </div>
</div>


        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              UWP基础教程 - XAML标记扩展
            </h2>
            <div class="post-info">
              <time class="post-time">
                · 2017-04-20 ·
              </time>
              
                <a href="https://songsong.org/tag/UWP" class="post-tag">
                  # UWP
                </a>
              
            </div>
            
            <div class="post-content">
              <p><strong>标记扩展</strong>（Markup Extensions）是一个被广泛使用的XAML语言概念。通过XAML标记扩展来设定属性值，从而可以让对象元素的属性具备更加灵活和复杂的赋值逻辑。
本文将详细介绍Windows 10 UWP开发中XAML标记扩展基础概念和使用方法。常用的XAML标记扩展功能包括：</p>
<ol>
<li><strong>Binding</strong>（绑定）标记扩展, 在XAML载入时，将数据绑定到XAML对象；</li>
<li><strong>StaticResource</strong>（静态资源）标记扩展， 实现引用数据字典（ResourceDictionary）中定义的静态资源；</li>
<li><strong>ThemeResource</strong> (主题资源）标记扩展，表示系统主题的静态资源；</li>
<li><strong>TemplateBinding</strong>（模板绑定）标记扩展， 实现在XAML页面中，对象模板绑定调用；</li>
<li><strong>RelativeSource</strong>（绑定关联源）标记扩展，实现对特定数据源绑定；</li>
</ol>
<p>XAML标记扩展语法格式：</p>
<pre><code>&lt;元素对象 对象属性=”{扩展标记 扩展标记属性 = 扩展属性值}” /&gt;
</code></pre>
<p><em><strong>Binding</strong></em></p>
<pre><code>&lt;TextBox Text=”{Binding Path=UserName}”/&gt;
</code></pre>
<p>以上代码中，第一行通过使用Binding标记扩展的Path属性将UserName绑定到元素对象TextBox的Text依赖属性中，使文本内容在运行时动态显示到客户端。</p>
<p><em><strong>StaticResource</strong></em></p>
<p>来看一个具体的例子</p>
<pre><code>&lt;Button ToolTipService.ToolTip=&quot;陈仁松XAML教程&quot;&gt;
    &lt;TextBlock Style=&quot;{StaticResource TextBlockStyle1}&quot; Text=&quot;{Binding Source={StaticResource Test},Path=Text}&quot;/&gt;
&lt;/Button&gt;
</code></pre>
<p>这个例子有三处使用了XAML代码，一处是<code>StaticResource</code>，另一处是<code>Binding</code> ，以及Binding里面的嵌套<code>StaticResource</code>,这种嵌套的语法叫做嵌套扩展，TextBlock元素的Text属性的值为{}中的结果,当XAML编译器看到{}时，把大括号中的内容解释为XAML标记扩展。</p>
<p><em><strong>ThemeResource</strong></em>
使用根据当前处于活动状态的主题检索不同资源的附加系统逻辑，通过计算对某个资源的引用来为任何 XAML 属性提供值。 与 {StaticResource} 标记扩展类似，资源在 ResourceDictionary 中定义，并且 ThemeResource 用法引用 ResourceDictionary 中的该资源的键。</p>
<pre><code>&lt;ResourceDictionary x:Key=&quot;Default&quot;&gt;
    &lt;SolidColorBrush x:Key=&quot;ApplicationPageBackgroundThemeBrush&quot; Color=&quot;#FF000000&quot; /&gt;
    &lt;SolidColorBrush x:Key=&quot;SystemControlBackgroundAccentBrush&quot; Color=&quot;{ThemeResource SystemAccentColor}&quot; /&gt;
&lt;/ResourceDictionary&gt;
&lt;ResourceDictionary x:Key=&quot;HighContrast&quot;&gt;
    &lt;SolidColorBrush x:Key=&quot;ApplicationPageBackgroundThemeBrush&quot; Color=&quot;{ThemeResource SystemColorWindowColor}&quot; /&gt;
    &lt;SolidColorBrush x:Key=&quot;SystemControlBackgroundAccentBrush&quot; Color=&quot;{ThemeResource SystemColorButtonFaceColor}&quot; /&gt;
&lt;/ResourceDictionary&gt;
</code></pre>
<p>以上代码包括了Default主题以及HighContrast主题的定义，如果你引用了某个系统资源，并且希望它发生更改以响应主题更改，则应当使用 ThemeResource 进行该引用。
<strong>TemplateBinding</strong>
相比前面三种标记，TemplateBinding标记扩展使用具有局限性，必须应用于ControlTemplate中，否则XAML将解析报错。
<strong>RelatvieSource</strong>
RelatvieSource标记扩展是较为特殊的一个标记扩展。 在前面的代码中，我们使用了ElementBinding元素绑定一个对象属性到另外一个对象属性。值得留意的是，ElementBinding元素绑定只有在源对象被命名后才能正常使用，而对RelativeSource则允许绑定未命名源对象属性到目标对象属性。 
<strong>Self模式</strong></p>
<pre><code>&lt;Binding RelativeSource=&quot;{RelativeSource Self}&quot; .../&gt;
</code></pre>
<p>或</p>
<pre><code>&lt;object property=&quot;{Binding RelativeSource={RelativeSource Self} ...}&quot; .../&gt;
</code></pre>
<p>RelativeSource使用Self模式时， 目标对象将作为源对象绑定到自身。这个模式可以实现同一对象元素不同属性之间的绑定操作。例如：</p>
<pre><code>&lt;TextBox Text=&quot;{Binding Path=UserName}&quot; ToolTipService.ToolTip=&quot;{Binding Text, RelativeSource={RelativeSource Self}}&quot; /&gt;
</code></pre>
<p>以上代码，附加属性ToolTipService.ToolTip使用RelativeSource标记扩展绑定控件自身Text属性，作为提示信息显示在客户端。</p>
<p><strong>TemplatedParent模式</strong></p>
<pre><code>&lt;Binding RelativeSource=&quot;{RelativeSource TemplatedParent}&quot; .../&gt;
</code></pre>
<p>或</p>
<pre><code>&lt;object property=&quot;{Binding RelativeSource={RelativeSource TemplatedParent} ...}&quot; .../&gt;
</code></pre>
<p>RelativeSource使用TemplatedParent模式时， 仅在控件模板（ControlTemplate）或者数据模板（DataTemplate）下有效。不同的模板，将返回不同类型的绑定结果。例如，在一个 ListBox数据模板（DataTemplate）中应用RelativeSource的TemplatedParent模式，则会返回 ContentPresenter模板内容到对应数据模板中。TemplatedParent模式可以帮助开发人员绑定模板中的属性值到目标对象属性。例如：</p>
<pre><code>&lt;Style TargetType=&quot;local:Calendar&quot;&gt;
    &lt;Setter Property=&quot;Template&quot;&gt;
        &lt;Setter.Value&gt;
            &lt;ControlTemplate TargetType=&quot;local:Calendar&quot;&gt;
                &lt;Grid&gt;
                    &lt;TextBlock Text=&quot;{Binding Path=Namer,RelativeSource={RelativeSource TemplatedParent},Mode=TwoWay}&quot; /&gt;
                                &lt;TextBlock Text=&quot;{TemplateBinding Namer}&quot; /&gt;
                    ......
&lt;/Style&gt;
</code></pre>
<p>在控件模板（ControlTemplate）中使用RelativeSource的TemplatedParent模式，”Binding RelativeSource={RelativeSource TemplatedParent}}“等价于”{TemplateBinding}&quot;标记扩展。
 
两者不同在于，TemplateBinding仅支持单向（One-Way）绑定，而RelativeSource标记扩展支持双向（Two-Way）绑定，这个功能在创建自定义控件模板时特别有用。</p>
<p>XAML本身也定义了一些<strong>内置标记扩展</strong>，这些包括：<code>x:Null</code>、<code>x:Type</code>、<code>x:Static</code>、<code>x:Array</code>。</p>
<ol>
<li><code>x:Null</code>是最简单的标记扩展，作用就是把目标属性设置为Null。例如：</li>
</ol>
<pre><code>&lt;object&gt;
  &lt;object.property&gt;
    &lt;x:Null /&gt;
  &lt;/object.property&gt;
&lt;/object&gt;
</code></pre>
<p>再看一个具体的例子，下面代码是将TextBlock背景设置为空;</p>
<pre><code>&lt;TextBlock Background = &quot;{x:Null}&quot;/&gt;
</code></pre>
<ol start="2">
<li><code>x:Type</code>在XAML中取对象的类型，类似于C#的typeof，这种操作发生在编译的时候;</li>
<li><code>x:Static</code>是用来把某个对象中的属性或域的值赋给目标对象的相关属性;</li>
<li><code>x:Array</code>表示一个.Net数组，<code>x:Array</code>元素的子元素都是数组元素，它必须和<code>x:Type</code>一起使用，用于定义数组类型;</li>
</ol>
<p>本文就介绍到这里，有什么问题欢迎留言讨论。</p>

            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://songsong.org/post/uwp-xaml-property">
              <h3 class="post-title">
                UWP基础教程 - XAML依赖属性和附加属性
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '382981c785b131b4a314',
    clientSecret: '048bc4e7cb57301643ef37a9b2a2ab6a08299deb',
    repo: 'chenrensong.github.io',
    owner: 'chenrensong',
    admin: ['chenrensong'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  京ICP备14060483号 | 
  <a class="rss" href="https://songsong.org/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
